<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EPFL Informatique 3rd Year Course Planner</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="container">
        <h1>EPFL Informatique 3rd Year Course Planner</h1>

        <!-- Top Summary Dashboard -->
        <div class="main-summary">
            <h2 class="summary-header">3rd Year Progress</h2>
            <table class="summary-table">
                <thead>
                    <tr>
                        <th>Category</th>
                        <th>BA5 Credits</th>
                        <th>BA6 Credits</th>
                        <th>Total 3rd Year (Requirement)</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Dynamic Rows -->
                    <tr>
                        <td>Physique/Bio Group</td>
                        <td id="summary-ba5-bio">0 cr</td>
                        <td id="summary-ba6-bio">0 cr</td>
                        <td>
                            <span id="summary-total-bio">0 / 4+ cr</span>
                            <span class="requirement-status incomplete" id="summary-bio-status"></span>
                        </td>
                    </tr>
                    <tr>
                        <td>Projets Group</td>
                        <td id="summary-ba5-projets">0 cr</td>
                        <td id="summary-ba6-projets">0 cr</td>
                        <td>
                            <span id="summary-total-projets">0 / 8+ cr</span>
                            <span class="requirement-status incomplete" id="summary-projets-status"></span>
                        </td>
                    </tr>
                    <tr>
                        <td>Options Group</td>
                        <td id="summary-ba5-options">0 cr</td>
                        <td id="summary-ba6-options">0 cr</td>
                        <td>
                            <span id="summary-total-options">0 / 28+ cr</span>
                            <span class="requirement-status incomplete" id="summary-options-status"></span>
                        </td>
                    </tr>
                    <!-- Fixed Rows -->
                    <tr class="fixed-row">
                        <td>Bloc C (Fixed)</td>
                        <td>6 cr</td>
                        <td>12 cr</td>
                        <td>
                            <span>18 / 18 cr</span>
                            <span class="requirement-status complete">COMPLETE</span>
                        </td>
                    </tr>
                    <tr class="fixed-row">
                        <td>SHS (Fixed)</td>
                        <td>2 cr</td>
                        <td>2 cr</td>
                        <td>
                            <span>4 / 4 cr</span>
                            <span class="requirement-status complete">COMPLETE</span>
                        </td>
                    </tr>
                </tbody>
                <tfoot>
                    <tr class="summary-total-row">
                        <td>Grand Total</td>
                        <td id="summary-ba5-total">8 cr</td>
                        <td id="summary-ba6-total">14 cr</td>
                        <td id="summary-grand-total">22 / 62 cr</td>
                    </tr>
                </tfoot>
            </table>
        </div>

        <div class="planner">
            <!-- BA5 (Autumn) Column -->
            <div class="semester-column">
                <h2 class="semester-title">BA5 (Autumn 2025)</h2>

                <div class="credits-summary">
                    <div class="credits-line"><span>Physique/Bio:</span> <span id="ba5-bio">0cr</span></div>
                    <div class="credits-line"><span>Projets:</span> <span id="ba5-projects">0cr</span></div>
                    <div class="credits-line"><span>Options:</span> <span id="ba5-options">0cr</span></div>
                    <div class="credits-line credits-total"><span>Total Selected:</span> <span id="ba5-total">0cr</span>
                    </div>
                    <div class="credits-line credits-final"><span>Semester Total:</span> <span id="ba5-final">8cr</span>
                    </div>
                </div>

                <div class="fixed-section">
                    <h3>Bloc C (Fixed)</h3>
                    <div class="fixed-course">
                        <div class="fixed-course-info">
                            Computer security and privacy<br>
                            <small>COM-301 • 6cr • EN</small>
                        </div>
                        <button class="fixed-course-btn"
                            onclick="openCourseLink('https://edu.epfl.ch/studyplan/fr/bachelor/informatique/coursebook/computer-security-and-privacy-COM-301')">Link</button>
                    </div>
                </div>

                <div class="category-section">
                    <div class="category-title">Options</div>
                    <div id="ba5-options-list"></div>
                </div>

                <div class="category-section">
                    <div class="category-title">Projects</div>
                    <div id="ba5-projects-list"></div>
                </div>

                <div class="category-section">
                    <div class="category-title">Bio/Physique</div>
                    <div id="ba5-bio-list"></div>
                </div>

                <div class="fixed-section">
                    <h3>SHS (Fixed)</h3>
                    <div>2 credits</div>
                </div>
            </div>

            <!-- Available Courses Column -->
            <div class="courses-column">
                <h2 style="text-align: center; margin-bottom: 20px;">Available Courses</h2>
                <div id="courses-container"></div>
            </div>

            <!-- BA6 (Spring) Column -->
            <div class="semester-column">
                <h2 class="semester-title">BA6 (Spring 2026)</h2>

                <div class="credits-summary">
                    <div class="credits-line"><span>Physique/Bio:</span> <span id="ba6-bio">0cr</span></div>
                    <div class="credits-line"><span>Projets:</span> <span id="ba6-projects">0cr</span></div>
                    <div class="credits-line"><span>Options:</span> <span id="ba6-options">0cr</span></div>
                    <div class="credits-line credits-total"><span>Total Selected:</span> <span id="ba6-total">0cr</span>
                    </div>
                    <div class="credits-line credits-final"><span>Semester Total:</span> <span
                            id="ba6-final">14cr</span></div>
                </div>

                <div class="fixed-section">
                    <h3>Bloc C (Fixed)</h3>
                    <div class="fixed-course">
                        <div class="fixed-course-info">
                            Data-intensive systems<br>
                            <small>CS-300 • 6cr • EN</small>
                        </div>
                        <button class="fixed-course-btn"
                            onclick="openCourseLink('https://edu.epfl.ch/studyplan/fr/bachelor/informatique/coursebook/data-intensive-systems-CS-300')">Link</button>
                    </div>
                    <div class="fixed-course" style="margin-top: 8px;">
                        <div class="fixed-course-info">
                            Theory of computation<br>
                            <small>CS-251 • 6cr • EN</small>
                        </div>
                        <button class="fixed-course-btn"
                            onclick="openCourseLink('https://edu.epfl.ch/studyplan/fr/bachelor/informatique/coursebook/theory-of-computation-CS-251')">Link</button>
                    </div>
                </div>

                <div class="category-section">
                    <div class="category-title">Options</div>
                    <div id="ba6-options-list"></div>
                </div>

                <div class="category-section">
                    <div class="category-title">Projects</div>
                    <div id="ba6-projects-list"></div>
                </div>

                <div class="category-section">
                    <div class="category-title">Bio/Physique</div>
                    <div id="ba6-bio-list"></div>
                </div>

                <div class="fixed-section">
                    <h3>SHS (Fixed)</h3>
                    <div>2 credits</div>
                </div>
            </div>
        </div>
    </div>

    <script src="courses.js"></script>
    <script>

        let selectedCourses = {
            BA5: [],
            BA6: []
        };

        // Track course toggles (courseId -> currentGroup)
        let courseToggles = {
            'CS-304': 'options'
        };
        // Track semester choices for flexible courses (only CS-304 research project)
        let courseSemesters = {
            'CS-304': 'BA5'     // Research project can be in BA5 or BA6
        };

        function openCourseLink(url) {
            window.open(url, '_blank');
        }

        function generateCourseCard(course) {
            const isToggleable = course.toggleable === true;
            const currentGroup = courseToggles[course.id] || course.group;
            let semesterDisplay = course.semesters[0]; // Show first semester

            // Check if this course has flexible semester selection
            const hasFlexibleSemester = courseSemesters.hasOwnProperty(course.id);
            if (hasFlexibleSemester) {
                semesterDisplay = courseSemesters[course.id];
            }

            // Map group names for display
            function getGroupDisplayName(groupName) {
                switch (groupName) {
                    case 'physique-bio': return 'Physique/Bio';
                    case 'projets': return 'Projets';
                    case 'options': return 'Options';
                    default: return groupName.charAt(0).toUpperCase() + groupName.slice(1);
                }
            }

            let toggleSection = '';
            if (isToggleable || hasFlexibleSemester) {
                toggleSection = '<div class="toggle-section">';

                // Group toggle (for toggleable courses)
                if (isToggleable) {
                    const currentDisplayName = getGroupDisplayName(currentGroup);
                    const originalDisplayName = getGroupDisplayName(course.group);
                    toggleSection += `
                        <div class="toggle-row">
                            <span>Count as:</span>
                            <button class="toggle-button" onclick="toggleCourseGroup('${course.id}')" id="toggle-${course.id}">
                                ${currentGroup === course.group ? originalDisplayName : 'Options'}
                            </button>
                        </div>
                    `;
                }

                // Semester toggle (for flexible semester courses)
                if (hasFlexibleSemester) {
                    toggleSection += `
                        <div class="toggle-row">
                            <span>Semester:</span>
                            <button class="toggle-button" onclick="toggleCourseSemester('${course.id}')" id="semester-${course.id}">
                                ${courseSemesters[course.id]}
                            </button>
                        </div>
                    `;
                }

                toggleSection += '</div>';
            }

            return `
                <div class="course-card ${course.group}-card" 
                     data-course="${course.id}" 
                     data-credits="${course.credits}" 
                     data-group="${course.group}" 
                     data-current-group="${currentGroup}"
                     data-semesters="${course.semesters.join(',')}"
                     data-toggleable="${isToggleable}">
                    <div class="course-title">${course.title}</div>
                    <div class="course-code">${course.code}</div>
                    <div class="course-details">
                        <div class="course-details-left">
                            <span class="course-group-indicator ${currentGroup}">${getGroupDisplayName(currentGroup)}</span>
                            <span class="course-semester">${semesterDisplay}</span>
                            <span class="course-language">${course.language}</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 5px;">
                            <button class="info-button" onclick="window.open('${course.link}', '_blank')">Link</button>
                            <span class="course-credits">${course.credits}cr</span>
                        </div>
                    </div>
                    ${toggleSection}
                </div>
            `;
        }

        function generateCourseGroup(groupName, courses, requirements) {
            const groupKey = groupName.toLowerCase().replace('/', '-');

            // 1. Find courses available in BOTH semesters
            const dualSemesterCourses = courses.filter(c =>
                (c.semesters.includes('BA5') || c.semesters.includes('BA3')) &&
                (c.semesters.includes('BA6') || c.semesters.includes('BA4'))
            );

            // 2. Find courses available ONLY in BA5 (Autumn)
            const ba5OnlyCourses = courses.filter(c =>
                (c.semesters.includes('BA5') || c.semesters.includes('BA3')) &&
                !(c.semesters.includes('BA6') || c.semesters.includes('BA4'))
            );

            // 3. Find courses available ONLY in BA6 (Spring)
            const ba6OnlyCourses = courses.filter(c =>
                (c.semesters.includes('BA6') || c.semesters.includes('BA4')) &&
                !(c.semesters.includes('BA5') || c.semesters.includes('BA3'))
            );

            let courseCards = '';

            // --- Render the partitioned groups in the desired order ---

            // Render DUAL-SEMESTER courses first
            if (dualSemesterCourses.length > 0) {
                courseCards += `<div class="semester-separator">Available in BA5 & BA6</div>`;
                dualSemesterCourses.sort((a, b) => a.title.localeCompare(b.title));
                dualSemesterCourses.forEach(course => {
                    courseCards += generateCourseCard(course);
                });
            }

            // Render BA5-ONLY courses next
            if (ba5OnlyCourses.length > 0) {
                courseCards += `<div class="semester-separator">BA5 (Autumn) Only</div>`;
                ba5OnlyCourses.sort((a, b) => a.title.localeCompare(b.title));
                ba5OnlyCourses.forEach(course => {
                    courseCards += generateCourseCard(course);
                });
            }

            // Render BA6-ONLY courses last
            if (ba6OnlyCourses.length > 0) {
                courseCards += `<div class="semester-separator">BA6 (Spring) Only</div>`;
                ba6OnlyCourses.sort((a, b) => a.title.localeCompare(b.title));
                ba6OnlyCourses.forEach(course => {
                    courseCards += generateCourseCard(course);
                });
            }

            // The rest of the function remains the same, returning the final HTML
            return `
                <div class="course-group ${groupKey}">
                    <div class="group-header" onclick="toggleGroup('${groupKey}')">
                        <h3>${groupName} Group (${requirements})</h3>
                        <div class="group-info">
                            <span class="group-credits" id="${groupKey}-credits">0 cr</span>
                            <span class="toggle" id="${groupKey}-toggle">−</span>
                        </div>
                    </div>
                    <div class="course-grid" id="${groupKey}-courses">
                        ${courseCards}
                    </div>
                </div>
            `;
        }

        function generateAllCourses() {
            const container = document.getElementById('courses-container');
            let html = '';

            html += generateCourseGroup('Physique/Bio', courseData['physique-bio'], '4+ credits required');
            html += generateCourseGroup('Projets', courseData['projets'], '8+ credits required');
            html += generateCourseGroup('Options', courseData['options'], '28+ credits required');

            container.innerHTML = html;
        }

        function toggleGroup(groupId) {
            const courses = document.getElementById(groupId + '-courses');
            const toggle = document.getElementById(groupId + '-toggle');

            if (courses.classList.contains('hidden')) {
                courses.classList.remove('hidden');
                toggle.textContent = '−';
            } else {
                courses.classList.add('hidden');
                toggle.textContent = '+';
            }
        }

        function toggleCourseGroup(courseId) {
            const courseCard = document.querySelector(`[data-course="${courseId}"]`);
            if (!courseCard) return;

            const originalGroup = courseCard.dataset.group;
            const currentGroup = courseToggles[courseId] || originalGroup;

            // Toggle between original group and options
            const newGroup = currentGroup === originalGroup ? 'options' : originalGroup;
            courseToggles[courseId] = newGroup;

            // Update course card
            courseCard.dataset.currentGroup = newGroup;

            // Update group indicator
            const groupIndicator = courseCard.querySelector('.course-group-indicator');
            groupIndicator.className = `course-group-indicator ${newGroup}`;

            // Map group names for display
            function getGroupDisplayName(groupName) {
                switch (groupName) {
                    case 'physique-bio': return 'Physique/Bio';
                    case 'projets': return 'Projets';
                    case 'options': return 'Options';
                    default: return groupName.charAt(0).toUpperCase() + groupName.slice(1);
                }
            }

            groupIndicator.textContent = getGroupDisplayName(newGroup);

            // Update toggle button
            const toggleBtn = document.getElementById(`toggle-${courseId}`);
            if (toggleBtn) {
                toggleBtn.textContent = newGroup === originalGroup ?
                    getGroupDisplayName(originalGroup) : 'Options';
            }

            // If course is already selected, update its group and re-render
            if (isCourseSelected(courseId)) {
                updateSelectedCourseGroup(courseId, newGroup);
                renderSelectedCourses();
            }
            updateCredits();
        }

        function toggleCourseSemester(courseId) {
            // Toggle semester for flexible courses
            const currentSemester = courseSemesters[courseId];
            const newSemester = currentSemester === 'BA5' ? 'BA6' : 'BA5';
            courseSemesters[courseId] = newSemester;

            // Update semester display in course card
            const courseCard = document.querySelector(`[data-course="${courseId}"]`);
            if (courseCard) {
                const semesterElement = courseCard.querySelector('.course-semester');
                if (semesterElement) {
                    semesterElement.textContent = newSemester;
                }
            }

            // Update toggle button
            const semesterBtn = document.getElementById(`semester-${courseId}`);
            if (semesterBtn) {
                semesterBtn.textContent = newSemester;
            }

            // If course is already selected, move it to the new semester
            if (isCourseSelected(courseId)) {
                moveCourseBetweenSemesters(courseId, newSemester);
                renderSelectedCourses();
            }
            updateCredits();
        }

        function moveCourseBetweenSemesters(courseId, targetSemester) {
            let courseData = null;
            ['BA5', 'BA6'].forEach(semester => {
                const courseIndex = selectedCourses[semester].findIndex(c => c.id === courseId);
                if (courseIndex !== -1) {
                    courseData = selectedCourses[semester].splice(courseIndex, 1)[0];
                }
            });

            if (courseData) {
                selectedCourses[targetSemester].push(courseData);
            }
        }

        function updateSelectedCourseGroup(courseId, newGroup) {
            ['BA5', 'BA6'].forEach(semester => {
                const courseIndex = selectedCourses[semester].findIndex(c => c.id === courseId);
                if (courseIndex !== -1) {
                    selectedCourses[semester][courseIndex].group = newGroup;
                }
            });
        }

        document.addEventListener('click', function (e) {
            // Check if clicked element is inside a course card
            const courseCard = e.target.closest('.course-card');

            if (courseCard && !e.target.closest('.toggle-section') && !e.target.classList.contains('info-button')) {
                toggleCourse(courseCard);
            } else if (e.target.classList.contains('remove-btn')) {
                removeCourse(e.target.dataset.courseId, e.target.dataset.semester);
            }
            // Note: semester-toggle-btn clicks are handled by their onclick attribute
        });

        function toggleCourse(courseCard) {
            const courseId = courseCard.dataset.course;

            if (isCourseSelected(courseId)) {
                // Remove course
                ['BA5', 'BA6'].forEach(semester => {
                    selectedCourses[semester] = selectedCourses[semester].filter(course => course.id !== courseId);
                });
                courseCard.classList.remove('selected');
            } else {
                // Determine target semester
                let targetSemester;

                // Check if this is a flexible semester course
                if (courseSemesters.hasOwnProperty(courseId)) {
                    targetSemester = courseSemesters[courseId];
                } else {
                    // Use direct semester mapping
                    const semesters = courseCard.dataset.semesters.split(',');

                    // Filter to only BA5/BA6 semesters, or map BA3→BA5, BA4→BA6
                    const availableSemesters = semesters.map(sem => {
                        if (sem === 'BA3') return 'BA5';
                        if (sem === 'BA4') return 'BA6';
                        return sem;
                    }).filter(sem => sem === 'BA5' || sem === 'BA6');

                    // For courses available in multiple semesters, use default first available
                    targetSemester = availableSemesters[0];
                }

                addCourseToSemester(courseCard, targetSemester);
            }

            renderSelectedCourses();
            updateCredits();
        }

        function addCourseToSemester(courseCard, semester) {
            const courseId = courseCard.dataset.course;
            const credits = parseInt(courseCard.dataset.credits);
            const currentGroup = courseToggles[courseId] || courseCard.dataset.group;

            const title = courseCard.querySelector('.course-title').textContent;
            const code = courseCard.querySelector('.course-code').textContent;

            const courseData = {
                id: courseId,
                title: title,
                code: code,
                credits: credits,
                group: currentGroup
            };

            selectedCourses[semester].push(courseData);
            courseCard.classList.add('selected');
        }

        function removeCourse(courseId, semester) {
            selectedCourses[semester] = selectedCourses[semester].filter(course => course.id !== courseId);

            // Unmark course card
            const courseCard = document.querySelector(`[data-course="${courseId}"]`);
            if (courseCard) {
                courseCard.classList.remove('selected');
            }

            renderSelectedCourses();
            updateCredits();
        }

        function isCourseSelected(courseId) {
            return selectedCourses.BA5.some(c => c.id === courseId) ||
                selectedCourses.BA6.some(c => c.id === courseId);
        }

        function renderSelectedCourses() {
            ['BA5', 'BA6'].forEach(semester => {
                // Clear all category sections
                ['options', 'projects', 'bio'].forEach(category => {
                    const container = document.getElementById(`${semester.toLowerCase()}-${category}-list`);
                    if (container) {
                        container.innerHTML = '';
                    }
                });

                // Group courses by category
                const coursesByCategory = {
                    options: [],
                    projets: [],
                    'physique-bio': []
                };

                selectedCourses[semester].forEach(course => {
                    // This check will now work for courses with group: 'projets'
                    if (coursesByCategory[course.group]) {
                        coursesByCategory[course.group].push(course);
                    }
                });

                // Render each category
                Object.keys(coursesByCategory).forEach(category => {
                    const courses = coursesByCategory[category];
                    if (courses.length === 0) return;

                    // Sort alphabetically
                    courses.sort((a, b) => a.title.localeCompare(b.title));

                    // This logic correctly maps 'projets' to the 'projects' container
                    let containerKey = category;
                    if (category === 'physique-bio') {
                        containerKey = 'bio';
                    } else if (category === 'projets') {
                        containerKey = 'projects';
                    }

                    const container = document.getElementById(`${semester.toLowerCase()}-${containerKey}-list`);
                    if (!container) return; // Safety check

                    courses.forEach(course => {
                        const courseDiv = document.createElement('div');
                        courseDiv.className = 'selected-course';

                        const canMoveSemesters = courseSemesters.hasOwnProperty(course.id);
                        const semesterToggle = canMoveSemesters ?
                            `<button class="semester-toggle-btn" onclick="moveSelectedCourseToOtherSemester('${course.id}', '${semester}')" title="Move to other semester">↔</button>` : '';

                        courseDiv.innerHTML = `
                    <div>
                        <strong>${course.title}</strong><br>
                        <small>${course.code} • ${course.credits}cr</small>
                    </div>
                    <div style="display: flex; align-items: center; gap: 5px;">
                        ${semesterToggle}
                        <button class="remove-btn" data-course-id="${course.id}" data-semester="${semester}">✕</button>
                    </div>
                `;
                        container.appendChild(courseDiv);
                    });
                });
            });
        }

        function moveSelectedCourseToOtherSemester(courseId, currentSemester) {
            const targetSemester = currentSemester === 'BA5' ? 'BA6' : 'BA5';

            // Update the courseSemesters tracking
            if (courseSemesters.hasOwnProperty(courseId)) {
                courseSemesters[courseId] = targetSemester;

                // Update the course card semester display
                const courseCard = document.querySelector(`[data-course="${courseId}"]`);
                if (courseCard) {
                    const semesterElement = courseCard.querySelector('.course-semester');
                    if (semesterElement) {
                        semesterElement.textContent = targetSemester;
                    }

                    // Update semester toggle button in course card
                    const semesterBtn = document.getElementById(`semester-${courseId}`);
                    if (semesterBtn) {
                        semesterBtn.textContent = targetSemester;
                    }
                }
            }

            // Move the course between semesters
            moveCourseBetweenSemesters(courseId, targetSemester);
            renderSelectedCourses();
            updateCredits();
        }

        function updateCredits() {
            // --- Per-Semester Calculations for Selected Courses ---
            const ba5_bio = selectedCourses.BA5.filter(c => c.group === 'physique-bio').reduce((sum, c) => sum + c.credits, 0);
            const ba5_projets = selectedCourses.BA5.filter(c => c.group === 'projets').reduce((sum, c) => sum + c.credits, 0);
            const ba5_options = selectedCourses.BA5.filter(c => c.group === 'options').reduce((sum, c) => sum + c.credits, 0);

            const ba6_bio = selectedCourses.BA6.filter(c => c.group === 'physique-bio').reduce((sum, c) => sum + c.credits, 0);
            const ba6_projets = selectedCourses.BA6.filter(c => c.group === 'projets').reduce((sum, c) => sum + c.credits, 0);
            const ba6_options = selectedCourses.BA6.filter(c => c.group === 'options').reduce((sum, c) => sum + c.credits, 0);

            // --- Total Year Calculations ---
            const totalBio = ba5_bio + ba6_bio;
            const totalProjets = ba5_projets + ba6_projets;
            const totalOptions = ba5_options + ba6_options;

            // --- Update Main Summary Table ---

            // Physique/Bio Row
            document.getElementById('summary-ba5-bio').textContent = ba5_bio + ' cr';
            document.getElementById('summary-ba6-bio').textContent = ba6_bio + ' cr';
            document.getElementById('summary-total-bio').textContent = `${totalBio} / 4+ cr`;
            updateRequirementStatus('summary-bio-status', totalBio >= 4);

            // Projets Row
            document.getElementById('summary-ba5-projets').textContent = ba5_projets + ' cr';
            document.getElementById('summary-ba6-projets').textContent = ba6_projets + ' cr';
            document.getElementById('summary-total-projets').textContent = `${totalProjets} / 8+ cr`;
            updateRequirementStatus('summary-projets-status', totalProjets >= 8);

            // Options Row
            document.getElementById('summary-ba5-options').textContent = ba5_options + ' cr';
            document.getElementById('summary-ba6-options').textContent = ba6_options + ' cr';
            document.getElementById('summary-total-options').textContent = `${totalOptions} / 28+ cr`;
            updateRequirementStatus('summary-options-status', totalOptions >= 28);

            // Grand Total Row
            const fixedBA5 = 8; // 6 (Bloc C) + 2 (SHS)
            const fixedBA6 = 14; // 12 (Bloc C) + 2 (SHS)
            const ba5GrandTotal = ba5_bio + ba5_projets + ba5_options + fixedBA5;
            const ba6GrandTotal = ba6_bio + ba6_projets + ba6_options + fixedBA6;
            const grandTotal = ba5GrandTotal + ba6GrandTotal;

            document.getElementById('summary-ba5-total').textContent = ba5GrandTotal + ' cr';
            document.getElementById('summary-ba6-total').textContent = ba6GrandTotal + ' cr';
            document.getElementById('summary-grand-total').textContent = `${grandTotal} / 62 cr`;

            // --- Update the per-semester summaries in the side columns ---
            document.getElementById('ba5-bio').textContent = ba5_bio + 'cr';
            document.getElementById('ba5-projects').textContent = ba5_projets + 'cr';
            document.getElementById('ba5-options').textContent = ba5_options + 'cr';
            document.getElementById('ba5-total').textContent = (ba5_bio + ba5_projets + ba5_options) + 'cr';
            document.getElementById('ba5-final').textContent = ba5GrandTotal + 'cr';

            document.getElementById('ba6-bio').textContent = ba6_bio + 'cr';
            document.getElementById('ba6-projects').textContent = ba6_projets + 'cr';
            document.getElementById('ba6-options').textContent = ba6_options + 'cr';
            document.getElementById('ba6-total').textContent = (ba6_bio + ba6_projets + ba6_options) + 'cr';
            document.getElementById('ba6-final').textContent = ba6GrandTotal + 'cr';

            // --- Update group credit counters in the "Available Courses" headers ---
            if (document.getElementById('physique-bio-credits')) {
                document.getElementById('physique-bio-credits').textContent = `${totalBio} cr`;
            }
            if (document.getElementById('projets-credits')) {
                document.getElementById('projets-credits').textContent = `${totalProjets} cr`;
            }
            if (document.getElementById('options-credits')) {
                document.getElementById('options-credits').textContent = `${totalOptions} cr`;
            }
        }

        function updateRequirementStatus(elementId, isComplete) {
            const statusElement = document.getElementById(elementId);
            if (isComplete) {
                statusElement.textContent = 'COMPLETE';
                statusElement.className = 'requirement-status complete';
            } else {
                statusElement.textContent = 'INCOMPLETE';
                statusElement.className = 'requirement-status incomplete';
            }
        }

        // Initialize the interface
        generateAllCourses();
        updateCredits();
    </script>
</body>

</html>
